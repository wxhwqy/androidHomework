# 天气APP

这是一个使用Kotlin和和风天气API开发的Android天气应用。

## 功能特点

### 1. 网络模块
- 使用和风天气API获取天气数据
- 使用OkHttp发起网络请求
- 使用Gson解析JSON数据
- 支持当前天气和7天预报查询

### 2. 界面展示
- **多城市支持**: 每个页面显示一个城市的天气信息
- **GPS定位**: 第一个页面显示GPS定位所在城市的天气
- **滑动切换**: 用户可以通过左右滑动在不同城市间切换
- **完整信息**: 显示当前温度、天气状况、最高/最低温度、体感温度、湿度、风速等
- **7天预报**: 显示未来一周的详细天气预报
- **下拉刷新**: 支持下拉刷新获取最新天气数据

### 3. 历史记录
- 使用SQLite数据库（Room）存储查询过的天气数据
- 智能缓存机制：如果数据已存在且未过期，优先使用缓存数据
- 缓存有效期：1小时
- 减少网络请求，提升用户体验

### 4. API测试功能
- 专门的API测试界面
- 支持测试当前天气API
- 支持测试7天预报API
- 支持测试城市搜索API
- 支持测试坐标天气API
- 实时显示API响应结果

## 技术架构

### 数据层
- **网络层**: OkHttp + Gson
- **数据库层**: Room (SQLite)
- **Repository模式**: 统一管理本地和网络数据源

### UI层
- **MVVM架构**: 使用Repository + ViewModel + LiveData
- **ViewPager2**: 实现城市间滑动切换
- **RecyclerView**: 显示7天天气预报列表
- **SwipeRefreshLayout**: 下拉刷新功能
- **ViewBinding**: 安全的视图绑定

### 权限管理
- 网络权限：访问网络获取天气数据
- 位置权限：获取用户当前位置

## 使用说明

### 基本操作
1. **查看天气**: 启动应用后自动显示当前位置天气
2. **切换城市**: 左右滑动切换不同城市的天气
3. **添加城市**: 点击菜单中的"添加城市"选择新城市
4. **刷新数据**: 下拉页面或点击菜单中的"刷新"按钮

### API测试
1. 在主界面菜单中选择"API测试"
2. 输入城市名称或坐标
3. 点击相应按钮测试不同API功能
4. 查看详细的API响应结果

## API配置

应用使用和风天气API，配置信息：
- API URL: `https://kq3h2pgah5.re.qweatherapi.com`
- API Key: 已在代码中配置
- 请求头: `X-QW-Api-Key`

## 依赖库

### 核心依赖
- **OkHttp**: 网络请求库
- **Gson**: JSON解析库
- **Room**: 本地数据库
- **ViewPager2**: 页面滑动
- **Google Play Services**: 位置服务

### UI组件
- **Material Design**: 现代化UI设计
- **CardView**: 卡片式布局
- **SwipeRefreshLayout**: 下拉刷新
- **RecyclerView**: 列表显示

## 开发环境要求

- Android Studio Arctic Fox 或更高版本
- Kotlin 1.8+
- Android API 28+ (Android 9.0)
- 网络连接（用于获取天气数据）

## 安装和运行

1. 克隆项目到本地
2. 使用Android Studio打开项目
3. 等待Gradle同步完成
4. 连接Android设备或启动模拟器
5. 点击运行按钮

## 注意事项

- 首次运行需要授予位置权限
- 需要网络连接才能获取最新天气数据
- 缓存数据有效期为1小时
- 支持的最低Android版本为9.0 (API 28) 